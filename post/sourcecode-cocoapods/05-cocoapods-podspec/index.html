<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>5. Podspec æ–‡ä»¶åˆ†æ - </title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="åœŸåœŸEdmondæœ¨" /><meta name="description" content="å¼•å­ åœ¨ä¸Šæ–‡ Podfile è§£æé€»è¾‘ ä¸­ï¼Œæˆ‘ä»¬ä»¥ Xcode å·¥ç¨‹ç»“æ„ä½œä¸ºåˆ‡å…¥ç‚¹ä»‹ç»äº† Podfile èƒŒåå¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œå‰–æäº† Podfile æ–‡ä»¶æ˜¯å¦‚ä½•è§£æä¸åŠ è½½ï¼Œå¹¶æœ€ç»ˆ &amp;ldquo;å…¥ä¾µ&amp;rdq" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.71.1 with theme even" />


<link rel="canonical" href="http://looseyi.github.io/post/sourcecode-cocoapods/05-cocoapods-podspec/" />
  <link href="http://looseyi.github.io/post/sourcecode-cocoapods/05-cocoapods-podspec/index.xml" rel="alternate" type="application/rss+xml" title="" />
  <link href="http://looseyi.github.io/post/sourcecode-cocoapods/05-cocoapods-podspec/index.xml" rel="feed" type="application/rss+xml" title="" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="5. Podspec æ–‡ä»¶åˆ†æ" />
<meta property="og:description" content="å¼•å­ åœ¨ä¸Šæ–‡ Podfile è§£æé€»è¾‘ ä¸­ï¼Œæˆ‘ä»¬ä»¥ Xcode å·¥ç¨‹ç»“æ„ä½œä¸ºåˆ‡å…¥ç‚¹ä»‹ç»äº† Podfile èƒŒåå¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œå‰–æäº† Podfile æ–‡ä»¶æ˜¯å¦‚ä½•è§£æä¸åŠ è½½ï¼Œå¹¶æœ€ç»ˆ &ldquo;å…¥ä¾µ&rdq" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://looseyi.github.io/post/sourcecode-cocoapods/05-cocoapods-podspec/" />
<meta property="article:published_time" content="2020-10-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-10-13T00:00:00+00:00" />
<meta itemprop="name" content="5. Podspec æ–‡ä»¶åˆ†æ">
<meta itemprop="description" content="å¼•å­ åœ¨ä¸Šæ–‡ Podfile è§£æé€»è¾‘ ä¸­ï¼Œæˆ‘ä»¬ä»¥ Xcode å·¥ç¨‹ç»“æ„ä½œä¸ºåˆ‡å…¥ç‚¹ä»‹ç»äº† Podfile èƒŒåå¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œå‰–æäº† Podfile æ–‡ä»¶æ˜¯å¦‚ä½•è§£æä¸åŠ è½½ï¼Œå¹¶æœ€ç»ˆ &ldquo;å…¥ä¾µ&rdq">
<meta itemprop="datePublished" content="2020-10-13T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-10-13T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="4929">



<meta itemprop="keywords" content="CocoaPods,iOS,Ruby," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="5. Podspec æ–‡ä»¶åˆ†æ"/>
<meta name="twitter:description" content="å¼•å­ åœ¨ä¸Šæ–‡ Podfile è§£æé€»è¾‘ ä¸­ï¼Œæˆ‘ä»¬ä»¥ Xcode å·¥ç¨‹ç»“æ„ä½œä¸ºåˆ‡å…¥ç‚¹ä»‹ç»äº† Podfile èƒŒåå¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œå‰–æäº† Podfile æ–‡ä»¶æ˜¯å¦‚ä½•è§£æä¸åŠ è½½ï¼Œå¹¶æœ€ç»ˆ &ldquo;å…¥ä¾µ&rdq"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Aha Moment</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Aha Moment</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">5. Podspec æ–‡ä»¶åˆ†æ</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-10-13 </span>
        <div class="post-category">
            <a href="/categories/cocoapods/"> CocoaPods </a>
            </div>
          <span class="more-meta"> çº¦ 4929 å­— </span>
          <span class="more-meta"> é¢„è®¡é˜…è¯» 10 åˆ†é’Ÿ </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#podspec-åˆæ¢">PodSpec åˆæ¢</a>
      <ul>
        <li><a href="#podspec-1">PodSpec</a></li>
        <li><a href="#convention-over-configuration">Convention Over Configuration</a></li>
      </ul>
    </li>
    <li><a href="#spec-çš„æ ¸å¿ƒæ•°æ®ç»“æ„">Spec çš„æ ¸å¿ƒæ•°æ®ç»“æ„</a>
      <ul>
        <li><a href="#specification">Specification</a></li>
        <li><a href="#subspecs">Subspecs</a></li>
      </ul>
    </li>
    <li><a href="#podspec-from-json">PodSpec From JSON</a></li>
    <li><a href="#podspec-from-ruby">PodSpec From Ruby</a>
      <ul>
        <li><a href="#attribute-wrappter">attribute wrappter</a></li>
        <li><a href="#subspec">#subspec</a></li>
        <li><a href="#dependency">#dependency</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#pod-åˆ›å»º">Pod åˆ›å»º</a>
      <ul>
        <li><a href="#0x1-åˆ›å»º-pod">0x1 åˆ›å»º Pod</a></li>
        <li><a href="#0x2-å‘å¸ƒ-pod">0x2 å‘å¸ƒ Pod</a></li>
      </ul>
    </li>
    <li><a href="#subspecs-in-podfile">SubSpecs In Podfile</a>
      <ul>
        <li><a href="#0x1-single-target">0x1 Single Target</a></li>
        <li><a href="#0x2-multiple-target">0x2 Multiple Target</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="å¼•å­">å¼•å­</h1>
<p>åœ¨ä¸Šæ–‡ <a href="https://zhuanlan.zhihu.com/p/248308670">Podfile è§£æé€»è¾‘</a> ä¸­ï¼Œæˆ‘ä»¬ä»¥ Xcode å·¥ç¨‹ç»“æ„ä½œä¸ºåˆ‡å…¥ç‚¹ä»‹ç»äº† Podfile èƒŒåå¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œå‰–æäº† <code>Podfile</code> æ–‡ä»¶æ˜¯å¦‚ä½•è§£æä¸åŠ è½½ï¼Œå¹¶æœ€ç»ˆ <em>&ldquo;å…¥ä¾µ&rdquo;</em> é¡¹ç›®å½±å“å…¶å·¥ç¨‹ç»“æ„çš„ã€‚ä»Šå¤©æˆ‘ä»¬æ¥èŠä¸€èŠ <em><a href="https://link.zhihu.com/?target=https%3A//github.com/CocoaPods/Core">CocoaPods-Core</a></em> ä¸­çš„å¦ä¸€ä¸ªé‡è¦æ–‡ä»¶ &mdash; <code>PodSpec</code> ä»¥åŠå®ƒæ‰€æ’‘èµ·çš„ CocoaPods ä¸–ç•Œã€‚</p>
<p>ä¸€ä¸ª <code>Pod</code> çš„åˆ›å»ºå’Œå‘å¸ƒç¦»ä¸å¼€ <code>PodSpec</code> æ–‡ä»¶ï¼Œå®ƒå¯ä»¥å¾ˆç®€å•ä¹Ÿèƒ½å¤æ‚ï¼Œå¦‚ <a href="https://github.com/Tencent/QMUI_iOS/blob/master/QMUIKit.podspec">QMUIKit</a>ï¼ˆåç»­ä»‹ç»)ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬å°±ç›´å¥”ä¸»é¢˜ï¼Œæ¥åˆ†æ <code>PodSpec</code> æ–‡ä»¶ã€‚</p>
<blockquote>
<p>Tipsï¼šå¦‚æœæœªçœ‹è¿‡<a href="https://zhuanlan.zhihu.com/p/248308670">å‰æ–‡</a>ï¼Œå¼ºçƒˆæ¨èã€‚</p>
</blockquote>
<h1 id="podspec">PodSpec</h1>
<blockquote>
<p>The Specification provides a DSL to describe a Pod. A pod is defined as a library originating from a source. A specification can support detailed attributes for modules of code through subspecs.</p>
</blockquote>
<p><code>PodSpec</code> æ˜¯ç”¨äº<strong>æè¿°ä¸€ä¸ª Pod åº“çš„æºä»£ç å’Œèµ„æºå°†å¦‚ä½•è¢«æ‰“åŒ…ç¼–è¯‘æˆé“¾æ¥åº“æˆ– framework çš„æ–‡ä»¶</strong>ï¼Œè€Œ <code>PodSpec</code> ä¸­çš„è¿™äº›æè¿°å†…å®¹æœ€ç»ˆå°†æ˜ ä¼šæ˜ å°„åˆ° <code>Specification</code> ç±»ä¸­ï¼ˆä»¥ä¸‹ç®€ç§° <strong>Spec</strong>ï¼‰ã€‚</p>
<p><img src="https://i.loli.net/2020/10/08/3MFQxdCNgTHuBIW.png" alt="01-Spec"></p>
<p>è®©æˆ‘ä»¬æ¥é‡æ–°è®¤è¯† <code>PodSpec</code>ã€‚</p>
<h2 id="podspec-åˆæ¢">PodSpec åˆæ¢</h2>
<p><code>PodSpec</code> æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ä¸º <code>.podspec</code> å’Œ <code>.json</code> ä¸¤ç§ï¼Œè€Œ <code>.podspec</code> æœ¬è´¨æ˜¯ Ruby æ–‡ä»¶ã€‚</p>
<p>é—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆæ˜¯ JSON æ ¼å¼è€Œä¸åƒ <code>Podfile</code> ä¸€æ ·æ”¯æŒ YAML å‘¢ï¼Ÿ</p>
<p>ç¬”è€…çš„ç†è§£ï¼šç”±äº <code>PodSpec</code> æ–‡ä»¶ä¼šæ»¡ä¸–ç•Œè·‘ï¼Œå®ƒå¯èƒ½å­˜åœ¨äº CocoaPods çš„ <a href="https://cdn.cocoapods.org/">CDN Service</a>ã€<a href="https://github.com/CocoaPods/Specs">Speces Repo</a> æˆ–è€…ä½ ä»¬çš„ç§æœ‰ Specs Repo ä¸Šï¼Œå› æ­¤é‡‡ç”¨  JSON çš„æ–‡ä»¶åœ¨ç½‘ç»œä¼ è¾“ä¸­ä¼šæ›´å‹å¥½ã€‚è€Œ <code>Podfile</code> æ›´å¤šçš„åœºæ™¯æ˜¯ç”¨äºåºåˆ—åŒ–ï¼Œå®ƒéœ€è¦åœ¨é¡¹ç›®ä¸­ç”Ÿæˆä¸€ä»½ç»ä¾èµ–ä»²è£åçš„ <code>Podfile</code> å¿«ç…§ï¼Œç”¨äºåç»­çš„å¯¹æ¯”ã€‚</p>
<h3 id="podspec-1">PodSpec</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="no">Pod</span><span class="o">::</span><span class="no">Spec</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">spec</span><span class="o">|</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">name</span>         <span class="o">=</span> <span class="s1">&#39;Reachability&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">version</span>      <span class="o">=</span> <span class="s1">&#39;3.1.0&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">license</span>      <span class="o">=</span> <span class="p">{</span> <span class="ss">:type</span> <span class="o">=&gt;</span> <span class="s1">&#39;BSD&#39;</span> <span class="p">}</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">homepage</span>     <span class="o">=</span> <span class="s1">&#39;https://github.com/tonymillion/Reachability&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">authors</span>      <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;Tony Million&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;tonymillion@gmail.com&#39;</span> <span class="p">}</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">summary</span>      <span class="o">=</span> <span class="s1">&#39;ARC and GCD Compatible Reachability Class for iOS and OS X.&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">source</span>       <span class="o">=</span> <span class="p">{</span> <span class="ss">:git</span> <span class="o">=&gt;</span> <span class="s1">&#39;https://github.com/tonymillion/Reachability.git&#39;</span><span class="p">,</span> <span class="ss">:tag</span> <span class="o">=&gt;</span> <span class="s2">&#34;v</span><span class="si">#{</span><span class="n">spec</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&#34;</span> <span class="p">}</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">source_files</span> <span class="o">=</span> <span class="s1">&#39;Reachability.{h,m}&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">framework</span>    <span class="o">=</span> <span class="s1">&#39;SystemConfiguration&#39;</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢è¿™ä»½ <code>Reachability.podspec</code> é…ç½®ï¼ŒåŸºæœ¬é€šè¿‡å‘½ä»¤è¡Œ <code>pod lib create NAME</code> å°±èƒ½å¸®æˆ‘ä»¬å®Œæˆã€‚é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬èƒ½åšçš„æ›´å¤šï¼Œæ¯”å¦‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ CococaPods ä¼šä¸ºæ¯ä¸ª <code>pod</code> framework ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„ <strong>modulemap</strong> æ–‡ä»¶ï¼Œå®ƒå°†åŒ…å« <code>PodSpec</code> ä¸­æŒ‡å®šçš„å…¬å…± headersã€‚å¦‚æœéœ€è¦è‡ªå®šä¹‰å¼•å…¥çš„ header æ–‡ä»¶ï¼Œä»…éœ€é…ç½® <code>moduel_map</code> å³å¯å®Œæˆã€‚</p>
<p>ä¸‹é¢æ˜¯è¿›é˜¶ç‰ˆé…ç½®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="no">Pod</span><span class="o">::</span><span class="no">Spec</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">spec</span><span class="o">|</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">name</span>         <span class="o">=</span> <span class="s1">&#39;Reachability&#39;</span>
  <span class="c1"># çœç•¥ä¸å‰é¢ç›¸åŒéƒ¨åˆ†çš„é…ç½® ...</span>
  
  <span class="n">spec</span><span class="o">.</span><span class="n">module_name</span>   <span class="o">=</span> <span class="s1">&#39;Rich&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">swift_version</span> <span class="o">=</span> <span class="s1">&#39;4.0&#39;</span>

  <span class="n">spec</span><span class="o">.</span><span class="n">ios</span><span class="o">.</span><span class="n">deployment_target</span>  <span class="o">=</span> <span class="s1">&#39;9.0&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">osx</span><span class="o">.</span><span class="n">deployment_target</span>  <span class="o">=</span> <span class="s1">&#39;10.10&#39;</span>

  <span class="n">spec</span><span class="o">.</span><span class="n">source_files</span>       <span class="o">=</span> <span class="s1">&#39;Reachability/common/*.swift&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">ios</span><span class="o">.</span><span class="n">source_files</span>   <span class="o">=</span> <span class="s1">&#39;Reachability/ios/*.swift&#39;</span><span class="p">,</span> <span class="s1">&#39;Reachability/extensions/*.swift&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">osx</span><span class="o">.</span><span class="n">source_files</span>   <span class="o">=</span> <span class="s1">&#39;Reachability/osx/*.swift&#39;</span>

  <span class="n">spec</span><span class="o">.</span><span class="n">framework</span>      <span class="o">=</span> <span class="s1">&#39;SystemConfiguration&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">ios</span><span class="o">.</span><span class="n">framework</span>  <span class="o">=</span> <span class="s1">&#39;UIKit&#39;</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">osx</span><span class="o">.</span><span class="n">framework</span>  <span class="o">=</span> <span class="s1">&#39;AppKit&#39;</span>

  <span class="n">spec</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;SomeOtherPod&#39;</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>åƒ ğŸ‘† æˆ‘ä»¬ä¸ºä¸åŒçš„ç³»ç»ŸæŒ‡å®šäº†ä¸åŒçš„æºç å’Œä¾èµ–ç­‰ï¼Œå½“ç„¶å¯é…ç½®çš„ä¸åªè¿™äº›ã€‚</p>
<p><code>PodSpec</code> æ”¯æŒçš„å®Œæ•´é…ç½®åˆ†ç±»å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2020/10/08/tDW3YNr4F2GXA1y.png" alt="01-Specification"></p>
<p>æƒ³äº†è§£æ›´å¤šçš„é…ç½®é€‰é¡¹ï¼š<a href="https://guides.cocoapods.org/syntax/podspec.html">ä¼ é€é—¨</a>ã€‚</p>
<h3 id="convention-over-configuration">Convention Over Configuration</h3>
<blockquote>
<p>Convention over configuration (akaï¼šcoding by convention) is a software design paradigm used by software frameworks that attempts to decrease the number of decisions that a developer using the framework is required to make without necessarily losing flexibility.</p>
</blockquote>
<p>è¯´åˆ°é…ç½®ï¼Œä¸å¾—ä¸æä¸€ä¸‹ <code>CoC</code> çº¦å®šå¤§äºé…ç½®ã€‚çº¦å®šå¤§äºé…ç½®ç®—æ˜¯åœ¨è½¯ä»¶å·¥ç¨‹è¾ƒæ—©å‡ºç°çš„æ¦‚å¿µçš„äº†ï¼Œå¤§æ„æ˜¯ï¼š<strong>ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬çš„ä»£ç éœ€è¦æŒ‰ç…§ä¸€å®šçš„çº¦å®šæ¥ç¼–å†™</strong>ï¼ˆå¦‚ä»£ç æ”¾åœ¨ä»€ä¹ˆç›®å½•ï¼Œç”¨ä»€ä¹ˆæ–‡ä»¶åï¼Œç”¨ä»€ä¹ˆç±»åç­‰)ã€‚ è¿™æ ·æ—¢ç®€åŒ–äº†é…ç½®æ–‡ä»¶ï¼ŒåŒæ—¶ä¹Ÿé™ä½äº†å­¦ä¹ æˆæœ¬ã€‚</p>
<p>çº¦å®šå¤§äºé…ç½®å¯ä»¥è¯´æ˜¯é€šè¿‡ <a href="https://www.wikiwand.com/en/Ruby_on_Rails">Ruby on Rails</a> å‘æ‰¬å…‰å¤§çš„ã€‚å°½ç®¡å®ƒä¸€ç›´é¥±å—äº‰è®®ï¼Œä½†æ˜¯ä¸»æµè¯­è¨€çš„ä¾èµ–ç®¡ç†å·¥å…·ï¼Œå¦‚ <em>Mavenï¼Œnpm</em> ç­‰éƒ½éµå¾ª <code>CoC</code> è¿›è¡Œä¸æ–­æ¼”è¿›çš„ï¼Œå› ä¸º <code>CoC</code> èƒ½å¤Ÿæœ‰æ•ˆå¸®åŠ©å¼€å‘è€…å‡è½»é€‰æ‹©çš„ç—›æ„Ÿï¼Œå‡å°‘æ— æ„ä¹‰çš„é€‰æ‹©ã€‚ä¸€äº›æ–°çš„è¯­è¨€ä¹Ÿå¸æ”¶äº†è¿™ä¸ªæ€æƒ³ï¼Œæ¯”å¦‚ Go è¯­è¨€ã€‚å¦‚æœç”¨ C/C++ å¯èƒ½éœ€è¦å®šä¹‰å¤æ‚çš„ Makefile æ¥å®šä¹‰ç¼–è¯‘çš„è§„åˆ™ï¼Œä»¥åŠå¦‚ä½•è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œè€Œåœ¨ Go ä¸­è¿™äº›éƒ½æ˜¯çº¦å®šå¥½çš„ã€‚</p>
<p>ä¸¾ä¸ª ğŸŒ° ï¼š<code>Podfile</code> ä¸­æ˜¯å¯ä»¥æŒ‡å®š pod library æ‰€é“¾æ¥çš„ Xcode projectï¼Œä¸è¿‡å¤§å¤šæƒ…å†µä¸‹æ— éœ€é…ç½®ï¼ŒCocoaPods ä¼šè‡ªåŠ¨æŸ¥æ‰¾ <code>Podfile</code> æ‰€åœ¨çš„åŒçº§ç›®å½•ä¸‹æ‰€å¯¹åº”çš„å·¥ç¨‹æ–‡ä»¶ <code>.project</code> ã€‚</p>
<h2 id="spec-çš„æ ¸å¿ƒæ•°æ®ç»“æ„">Spec çš„æ ¸å¿ƒæ•°æ®ç»“æ„</h2>
<h3 id="specification">Specification</h3>
<p>åœ¨æ•°æ®ç»“æ„ä¸Š <code>Specification</code> ä¸ <a href="https://looseyi.github.io/post/sourcecode-cocoapods/04-cocoapods-podfile/#targetdefinition">TargetDefinition</a> æ˜¯ç±»ä¼¼çš„ï¼Œ<strong>åŒä¸ºå¤šå‰æ ‘ç»“æ„</strong>ã€‚ç®€åŒ–åçš„ <code>Spec</code> çš„ç±»å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">&#39;active_support/core_ext/string/strip.rb&#39;</span>
<span class="c1"># è®°å½•å¯¹åº” platform ä¸Š Spec çš„å…¶ä»– pod ä¾èµ–</span>
<span class="nb">require</span> <span class="s1">&#39;cocoapods-core/specification/consumer&#39;</span>
<span class="c1"># è§£æ DSL</span>
<span class="nb">require</span> <span class="s1">&#39;cocoapods-core/specification/dsl&#39;</span>
<span class="c1"># æ ¡éªŒ Spec çš„æ­£ç¡®æ€§ï¼Œå¹¶æŠ›å‡ºå¯¹åº”çš„é”™è¯¯å’Œè­¦å‘Š</span>
<span class="nb">require</span> <span class="s1">&#39;cocoapods-core/specification/linter&#39;</span>
<span class="c1"># ç”¨äºè§£æ DSL å†…å®¹åŒ…å«çš„é…ç½®ä¿¡æ¯</span>
<span class="nb">require</span> <span class="s1">&#39;cocoapods-core/specification/root_attribute_accessors&#39;</span>
<span class="c1"># è®°å½•ä¸€ä¸ª Pod æ‰€æœ‰ä¾èµ–çš„ Spec æ¥æºä¿¡æ¯</span>
<span class="nb">require</span> <span class="s1">&#39;cocoapods-core/specification/set&#39;</span>
<span class="c1"># json æ ¼å¼æ•°æ®è§£æ</span>
<span class="nb">require</span> <span class="s1">&#39;cocoapods-core/specification/json&#39;</span>

<span class="k">module</span> <span class="nn">Pod</span>
  <span class="k">class</span> <span class="nc">Specification</span>
    <span class="kp">include</span> <span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span><span class="o">::</span><span class="no">DSL</span>
    <span class="kp">include</span> <span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span><span class="o">::</span><span class="no">DSL</span><span class="o">::</span><span class="no">Deprecations</span>
    <span class="kp">include</span> <span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span><span class="o">::</span><span class="no">RootAttributesAccessors</span>
    <span class="kp">include</span> <span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span><span class="o">::</span><span class="no">JSONSupport</span>
 
    <span class="c1"># `subspec` çš„çˆ¶èŠ‚ç‚¹</span>
    <span class="kp">attr_reader</span> <span class="ss">:parent</span>
    <span class="c1"># `Spec` çš„å”¯ä¸€ idï¼Œç”± name + version çš„ hash æ„æˆ</span>
    <span class="kp">attr_reader</span> <span class="ss">:hash_value</span>
    <span class="c1"># è®°å½• `Spec` çš„é…ç½®ä¿¡æ¯ </span>
    <span class="kp">attr_accessor</span> <span class="ss">:attributes_hash</span>
    <span class="c1"># `Spec` åŒ…å«çš„ `subspec`</span>
    <span class="kp">attr_accessor</span> <span class="ss">:subspecs</span>
     
    <span class="c1"># é€’å½’è°ƒç”¨è·å– Specification çš„æ ¹èŠ‚ç‚¹</span>
    <span class="k">def</span> <span class="nf">root</span>
      <span class="n">parent</span> <span class="p">?</span> <span class="n">parent</span><span class="o">.</span><span class="n">root</span> <span class="p">:</span> <span class="nb">self</span>
    <span class="k">end</span>
     
	 <span class="k">def</span> <span class="nf">hash</span>
   	<span class="k">if</span> <span class="vi">@hash_value</span><span class="o">.</span><span class="n">nil?</span>
      	<span class="vi">@hash_value</span> <span class="o">=</span> <span class="p">(</span><span class="nb">name</span><span class="o">.</span><span class="n">hash</span> <span class="o">*</span> <span class="mi">53</span><span class="p">)</span> <span class="o">^</span> <span class="n">version</span><span class="o">.</span><span class="n">hash</span>
		<span class="k">end</span>
      <span class="vi">@hash_value</span>
    <span class="k">end</span>
    <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Specification</code> åŒæ ·ç”¨ map <code>attributes_hash</code> æ¥è®°å½•é…ç½®ä¿¡æ¯ã€‚</p>
<p>âš ï¸ è¿™é‡Œçš„ parent æ˜¯ä¸º <code>subspec</code> ä¿ç•™çš„ï¼Œç”¨äºæŒ‡å‘å…¶çˆ¶èŠ‚ç‚¹çš„ <code>Spec</code>ã€‚</p>
<p><img src="https://i.loli.net/2020/10/08/L8MkIO3bD4dJXqR.png" alt="02-PodSpec-Dependency"></p>
<h3 id="subspecs">Subspecs</h3>
<blockquote>
<p>A library can specify a dependency on either another library, a subspec of another library, or a subspec of itself.</p>
</blockquote>
<p>ä¹ä¸€å¬ <code>Subspec</code> è¿™ä¸ªæ¦‚å¿µä¼¼ä¹æœ‰ä¸€äº›æŠ½è±¡ï¼Œä¸è¿‡å½“ä½ ç†è§£äº†ä¸Šé¢çš„æè¿°ï¼Œå°±èƒ½æ˜ç™½ä»€ä¹ˆæ˜¯ <code>Subspec</code> äº†ã€‚æˆ‘ä»¬çŸ¥é“åœ¨ Xcode é¡¹ç›®ä¸­ï¼Œtarget ä½œä¸ºæœ€å°çš„å¯ç¼–è¯‘å•å…ƒï¼Œå®ƒç¼–è¯‘åçš„äº§ç‰©ä¸ºé“¾æ¥åº“æˆ– frameworkã€‚è€Œåœ¨ CocoaPods çš„ä¸–ç•Œé‡Œè¿™äº› targets åˆ™æ˜¯ç”± <code>Spec</code> æ–‡ä»¶æ¥æè¿°çš„ï¼Œå®ƒè¿˜èƒ½æ‹†åˆ†æˆä¸€ä¸ªæˆ–è€…å¤šä¸ª <code>Subspec</code>ï¼Œæˆ‘ä»¬æš‚ä¸”æŠŠå®ƒç§°ä¸º <code>Spec</code> çš„<strong>å­æ¨¡å—</strong>ï¼Œå­æ¨¡å—ä¹Ÿæ˜¯ç”¨ <strong>Specification</strong> ç±»æ¥æè¿°çš„ã€‚</p>
<p>**å­æ¨¡å—å¯ä»¥å•ç‹¬ä½œä¸ºä¾èµ–è¢«å¼•å…¥åˆ°é¡¹ç›®ä¸­ã€‚**å®ƒæœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li>æœªæŒ‡å®š <code>default_subspec</code> çš„æƒ…å†µä¸‹ï¼Œ<code>Spec</code> çš„å…¨éƒ¨å­æ¨¡å—éƒ½å°†ä½œä¸ºä¾èµ–è¢«å¼•å…¥ï¼›</li>
<li>å­æ¨¡å—ä¼šä¸»åŠ¨ç»§æ‰¿å…¶çˆ¶èŠ‚ç‚¹ <code>Spec</code> ä¸­å®šä¹‰çš„ <code>attributes_hash</code>ï¼›</li>
<li>å­æ¨¡å—å¯ä»¥æŒ‡å®šè‡ªå·±çš„æºä»£ç ã€èµ„æºæ–‡ä»¶ã€ç¼–è¯‘é…ç½®ã€ä¾èµ–ç­‰ï¼›</li>
<li>åŒä¸€ <code>Spec</code> å†…éƒ¨çš„å­æ¨¡å—æ˜¯å¯ä»¥æœ‰ä¾èµ–å…³ç³»çš„ï¼›</li>
<li>æ¯ä¸ªå­æ¨¡å—åœ¨ <code>pod push</code> çš„æ—¶å€™æ˜¯éœ€è¦è¢« lint é€šè¿‡çš„ï¼›</li>
</ul>
<p>å…‰å¬æ€»ç»“ä¼¼ä¹è¿˜æ˜¯äº‘é‡Œé›¾é‡Œï¼Œç¥­å‡º QMUI è®©å¤§å®¶æ„Ÿå—ä¸€ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="no">Pod</span><span class="o">::</span><span class="no">Spec</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="n">s</span><span class="o">.</span><span class="n">name</span>             <span class="o">=</span> <span class="s2">&#34;QMUIKit&#34;</span>
  <span class="n">s</span><span class="o">.</span><span class="n">version</span>          <span class="o">=</span> <span class="s2">&#34;4.2.1&#34;</span>
  <span class="c1"># ...</span>
  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">&#39;QMUICore&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">ss</span><span class="o">|</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">source_files</span> <span class="o">=</span> <span class="s1">&#39;QMUIKit/QMUIKit.h&#39;</span><span class="p">,</span> <span class="s1">&#39;QMUIKit/QMUICore&#39;</span><span class="p">,</span> <span class="s1">&#39;QMUIKit/UIKitExtensions&#39;</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;QMUIKit/QMUIWeakObjectContainer&#39;</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;QMUIKit/QMUILog&#39;</span>
  <span class="k">end</span>

  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">&#39;QMUIWeakObjectContainer&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">ss</span><span class="o">|</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">source_files</span> <span class="o">=</span> <span class="s1">&#39;QMUIKit/QMUIComponents/QMUIWeakObjectContainer.{h,m}&#39;</span>
  <span class="k">end</span>

  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">&#39;QMUILog&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">ss</span><span class="o">|</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">source_files</span> <span class="o">=</span> <span class="s1">&#39;QMUIKit/QMUIComponents/QMUILog/*.{h,m}&#39;</span>
  <span class="k">end</span>

  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">&#39;QMUIComponents&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">ss</span><span class="o">|</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;QMUIKit/QMUICore&#39;</span>
     
    <span class="n">ss</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">&#39;QMUIButton&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">sss</span><span class="o">|</span>
      <span class="n">sss</span><span class="o">.</span><span class="n">source_files</span> <span class="o">=</span> <span class="s1">&#39;QMUIKit/QMUIComponents/QMUIButton/QMUIButton.{h,m}&#39;</span>
    <span class="k">end</span>
    <span class="c1"># æ­¤å¤„çœç•¥ 59 ä¸ª Components</span>
  <span class="k">end</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ä¸å¹ä¸é»‘ï¼ŒQMUI æ˜¯ç¬”è€…è§è¿‡å›½å†…å¼€æºä½œå“ä¸­ä»£ç æ³¨é‡Šéå¸¸è¯¦å°½ä¸”æä¾›å®Œæ•´ Demo çš„é¡¹ç›®ä¹‹ä¸€ã€‚</p>
<p><strong>QMUI ğŸ‚ ğŸº</strong></p>
</blockquote>
<p>æ•´ä¸ª QMUIKit çš„ <code>Spec</code> æ–‡ä»¶ä¸­ï¼Œæ€»å…±å®šä¹‰äº† <strong>64</strong> ä¸ª <code>subspec</code> å­æ¨¡å—ï¼ŒåŒæ—¶è¿™äº›å­æ¨¡å—ä¹‹é—´è¿˜åšäº†åˆ†å±‚ã€‚æ¯”å¦‚ QMUICoreï¼š</p>
<p><img src="https://i.loli.net/2020/10/08/EQTshCgymAzUXnZ.png" alt="03-QMUICore"></p>
<p>å¦å¤–è¡¥å……ä¸€ç‚¹ï¼ŒCocoaPods æ”¯æŒäº†ä¸åŒç±»å‹çš„ <code>SubSpec</code>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># lib/cocoapods-core/specification/dsl/attribute_support.rb</span>

<span class="no">SUPPORTED_SPEC_TYPES</span> <span class="o">=</span> <span class="o">[</span><span class="ss">:library</span><span class="p">,</span> <span class="ss">:app</span><span class="p">,</span> <span class="ss">:test</span><span class="o">].</span><span class="n">freeze</span>
</code></pre></td></tr></table>
</div>
</div><p><code>:app</code> å’Œ <code>:test</code> ç”¨äºåœ¨é¡¹ç›®ä¸­é›†æˆå•å…ƒæµ‹è¯•ä»£ç çš„ <code>Subspec</code>ã€‚</p>
<h2 id="podspec-from-json">PodSpec From JSON</h2>
<p>æœ‰äº†ä¸Šæ–‡ <code>Podfile</code> çš„äº†è§£ï¼Œè¿™æ¬¡æˆ‘ä»¬å¯¹ <code>PodSpec</code> çš„æ–‡ä»¶åŠ è½½ä¼šæ›´åŠ è½»è½¦ç†Ÿè·¯ã€‚é¦–å…ˆæ˜¯ç”± <code>#from_file</code> æ–¹æ³•è¿›è¡Œæ–‡ä»¶è·¯å¾„å’Œå†…å®¹ç¼–ç æ ¼å¼çš„æ£€æŸ¥ï¼Œå°†åŠ è½½çš„å†…å®¹è½¬å…¥ <code>#from_string</code>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">subspec_name</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
  <span class="n">path</span> <span class="o">=</span> <span class="no">Pathname</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
  <span class="k">unless</span> <span class="n">path</span><span class="o">.</span><span class="n">exist?</span>
    <span class="k">raise</span> <span class="no">Informative</span><span class="p">,</span> <span class="s2">&#34;No podspec exists at path `</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">`.&#34;</span>
  <span class="k">end</span>

  <span class="n">string</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r:utf-8&#39;</span><span class="p">,</span> <span class="o">&amp;</span><span class="ss">:read</span><span class="p">)</span>
  <span class="c1"># Work around for Rubinius incomplete encoding in 1.9 mode</span>
  <span class="k">if</span> <span class="n">string</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="ss">:encoding</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">string</span><span class="o">.</span><span class="n">encoding</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;UTF-8&#39;</span>
    <span class="n">string</span><span class="o">.</span><span class="n">encode!</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">from_string</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">subspec_name</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_string</span><span class="p">(</span><span class="n">spec_contents</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">subspec_name</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
  <span class="n">path</span> <span class="o">=</span> <span class="no">Pathname</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">expand_path</span>
  <span class="n">spec</span> <span class="o">=</span> <span class="kp">nil</span>
  <span class="k">case</span> <span class="n">path</span><span class="o">.</span><span class="n">extname</span>
  <span class="k">when</span> <span class="s1">&#39;.podspec&#39;</span>
    <span class="no">Dir</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">directory?</span> <span class="p">?</span> <span class="n">path</span><span class="o">.</span><span class="n">parent</span> <span class="p">:</span> <span class="no">Dir</span><span class="o">.</span><span class="n">pwd</span><span class="p">)</span> <span class="k">do</span>
     <span class="n">spec</span> <span class="o">=</span> <span class="o">::</span><span class="no">Pod</span><span class="o">.</span><span class="n">_eval_podspec</span><span class="p">(</span><span class="n">spec_contents</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
     <span class="k">unless</span> <span class="n">spec</span><span class="o">.</span><span class="n">is_a?</span><span class="p">(</span><span class="no">Specification</span><span class="p">)</span>
      <span class="k">raise</span> <span class="no">Informative</span><span class="p">,</span> <span class="s2">&#34;Invalid podspec file at path `</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">`.&#34;</span>
     <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">when</span> <span class="s1">&#39;.json&#39;</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="no">Specification</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">spec_contents</span><span class="p">)</span>
  <span class="k">else</span>
 	 <span class="k">raise</span> <span class="no">Informative</span><span class="p">,</span> <span class="s2">&#34;Unsupported specification format `</span><span class="si">#{</span><span class="n">path</span><span class="o">.</span><span class="n">extname</span><span class="si">}</span><span class="s2">` for spec at `</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">`.&#34;</span>
  <span class="k">end</span>

  <span class="n">spec</span><span class="o">.</span><span class="n">defined_in_file</span> <span class="o">=</span> <span class="n">path</span>
  <span class="n">spec</span><span class="o">.</span><span class="n">subspec_by_name</span><span class="p">(</span><span class="n">subspec_name</span><span class="p">,</span> <span class="kp">true</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>æ¥ç€æ ¹æ®æ–‡ä»¶ç±»å‹ä¸º <code>.podspec</code> å’Œ <code>.json</code> åˆ†åˆ«é‡‡ç”¨ä¸åŒçš„è§£ææ–¹å¼ã€‚åœ¨  <strong>JSONSupport</strong> æ¨¡å—å†…å°† <code>#from_json</code> çš„é€»è¾‘æ‹†æˆäº†ä¸¤éƒ¨åˆ†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># `lib/cocoapods-core/specification/json.rb`</span>
<span class="k">module</span> <span class="nn">Pod</span>
  <span class="k">class</span> <span class="nc">Specification</span>
    <span class="k">module</span> <span class="nn">JSONSupport</span>
      <span class="c1"># â‘ </span>
      <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_json</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
        <span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
        <span class="nb">hash</span> <span class="o">=</span> <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">json</span><span class="p">)</span>
        <span class="n">from_hash</span><span class="p">(</span><span class="nb">hash</span><span class="p">)</span>
      <span class="k">end</span>
  <span class="c1"># â‘¡</span>
      <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_hash</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="ss">test_specification</span><span class="p">:</span> <span class="kp">false</span><span class="p">,</span> <span class="ss">app_specification</span><span class="p">:</span> <span class="kp">false</span><span class="p">)</span>
        <span class="n">attributes_hash</span> <span class="o">=</span> <span class="nb">hash</span><span class="o">.</span><span class="n">dup</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="no">Spec</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">test_specification</span><span class="p">,</span> <span class="ss">:app_specification</span> <span class="o">=&gt;</span> <span class="n">app_specification</span><span class="p">)</span>
        <span class="n">subspecs</span> <span class="o">=</span> <span class="n">attributes_hash</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;subspecs&#39;</span><span class="p">)</span>
        <span class="n">testspecs</span> <span class="o">=</span> <span class="n">attributes_hash</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;testspecs&#39;</span><span class="p">)</span>
        <span class="n">appspecs</span> <span class="o">=</span> <span class="n">attributes_hash</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;appspecs&#39;</span><span class="p">)</span>
    
        <span class="c1">## backwards compatibility with 1.3.0</span>
        <span class="n">spec</span><span class="o">.</span><span class="n">test_specification</span> <span class="o">=</span> <span class="o">!</span><span class="n">attributes_hash</span><span class="o">[</span><span class="s1">&#39;test_type&#39;</span><span class="o">].</span><span class="n">nil?</span>
    
        <span class="n">spec</span><span class="o">.</span><span class="n">attributes_hash</span> <span class="o">=</span> <span class="n">attributes_hash</span>
        <span class="n">spec</span><span class="o">.</span><span class="n">subspecs</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">subspecs_from_hash</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">subspecs</span><span class="p">,</span> <span class="kp">false</span><span class="p">,</span> <span class="kp">false</span><span class="p">))</span>
        <span class="n">spec</span><span class="o">.</span><span class="n">subspecs</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">subspecs_from_hash</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">testspecs</span><span class="p">,</span> <span class="kp">true</span><span class="p">,</span> <span class="kp">false</span><span class="p">))</span>
        <span class="n">spec</span><span class="o">.</span><span class="n">subspecs</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">subspecs_from_hash</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">appspecs</span><span class="p">,</span> <span class="kp">false</span><span class="p">,</span> <span class="kp">true</span><span class="p">))</span>
    
        <span class="n">spec</span>
      <span class="k">end</span>
  	  <span class="c1"># â‘¢</span>
      <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">subspecs_from_hash</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">subspecs</span><span class="p">,</span> <span class="n">test_specification</span><span class="p">,</span> <span class="n">app_specification</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">[]</span> <span class="k">if</span> <span class="n">subspecs</span><span class="o">.</span><span class="n">nil?</span>
        <span class="n">subspecs</span><span class="o">.</span><span class="n">map</span> <span class="k">do</span> <span class="o">|</span><span class="n">s_hash</span><span class="o">|</span>
          <span class="no">Specification</span><span class="o">.</span><span class="n">from_hash</span><span class="p">(</span><span class="n">s_hash</span><span class="p">,</span> <span class="n">spec</span><span class="p">,</span>
                                  <span class="ss">:test_specification</span> <span class="o">=&gt;</span> <span class="n">test_specification</span><span class="p">,</span>
                                  <span class="ss">:app_specification</span> <span class="o">=&gt;</span> <span class="n">app_specification</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œçš„é€»è¾‘ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•ï¼š</p>
<p>â‘   å°†ä¼ å…¥çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º jsonï¼›
â‘¡ å°†è½¬æ¢åçš„ json è½¬æ¢ä¸º <code>Spec</code> å¯¹è±¡å¹¶å°† json è½¬æ¢ä¸º <code>attributes_hash</code>ï¼ŒåŒæ—¶è§¦å‘ â‘¢ï¼›
â‘¢ é€šè¿‡ <code>self.subspecs_from_hash</code> å®ç°é€’å½’è°ƒç”¨å®Œæˆ <code>subspecs</code> è§£æï¼›</p>
<blockquote>
<p>Tips: æ–¹æ³• â‘¡ é‡Œçš„ <strong>Spec</strong> æ˜¯å¯¹ <code>Specification</code> çš„åˆ«åã€‚</p>
</blockquote>
<p><img src="https://i.loli.net/2020/10/08/fm3xhI5jZidwvuP.png" alt="04-podspec-from-json"></p>
<h2 id="podspec-from-ruby">PodSpec From Ruby</h2>
<p><code>QMUIKit.podspec</code> çš„æ–‡ä»¶å†…å®¹ï¼Œå¤§å®¶æ˜¯å¦æ³¨æ„åˆ°å…¶å¼€å¤´çš„å£°æ˜ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="no">Pod</span><span class="o">::</span><span class="no">Spec</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="n">s</span><span class="o">.</span><span class="n">name</span>             <span class="o">=</span> <span class="s2">&#34;QMUIKit&#34;</span>
  <span class="n">s</span><span class="o">.</span><span class="n">source_files</span>     <span class="o">=</span> <span class="s1">&#39;QMUIKit/QMUIKit.h&#39;</span>
  <span class="c1"># ...</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>å‘ç°æ²¡ <code>.podspec</code> æ–‡ä»¶å°±æ˜¯<strong>ç®€å•ç›´æ¥åœ°å£°æ˜äº†ä¸€ä¸ª <code>Specifiction</code> å¯¹è±¡</strong>ï¼Œç„¶åé€šè¿‡ block å—å®šåˆ¶æ¥å®Œæˆé…ç½®ã€‚åƒ <code>name</code>ã€<code>source_files</code> è¿™äº›é…ç½®å‚æ•°æœ€ç»ˆéƒ½ä¼šè½¬æ¢ä¸ºæ–¹æ³•è°ƒç”¨å¹¶å°†å€¼å­˜å…¥ <code>attributes_hash</code> ä¸­ã€‚è¿™äº›æ–¹æ³•è°ƒç”¨çš„å®ç°æ–¹å¼åˆ†ä¸¤ç§ï¼š</p>
<ol>
<li>å¤§éƒ¨åˆ†é…ç½®æ˜¯é€šè¿‡æ–¹æ³•åŒ…è£…å™¨ <code>attribute</code> å’Œ <code>root_attribute</code> æ¥åŠ¨æ€æ·»åŠ çš„ setter æ–¹æ³•ï¼›</li>
<li>å¯¹äºå¤æ‚é€»è¾‘çš„é…ç½®åˆ™ç›´æ¥æ–¹æ³•å£°æ˜ï¼Œå¦‚ <code>subspec</code> ã€<code>dependency</code> æ–¹æ³•ç­‰ï¼ˆåç»­ä»‹ç»)ã€‚</li>
</ol>
<h3 id="attribute-wrappter">attribute wrappter</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># `lib/cocoapods-core/specification/dsl.rb`</span>
<span class="k">module</span> <span class="nn">Pod</span>
   <span class="k">class</span> <span class="nc">Specification</span>
      <span class="k">module</span> <span class="nn">DSL</span>
         <span class="kp">extend</span> <span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span><span class="o">::</span><span class="no">DSL</span><span class="o">::</span><span class="no">AttributeSupport</span>
         <span class="c1"># Deprecations must be required after include AttributeSupport</span>
         <span class="nb">require</span> <span class="s1">&#39;cocoapods-core/specification/dsl/deprecations&#39;</span>

         <span class="n">attribute</span> <span class="ss">:name</span><span class="p">,</span>
                   <span class="ss">:required</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
                   <span class="ss">:inherited</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">,</span>
                   <span class="ss">:multi_platform</span> <span class="o">=&gt;</span> <span class="kp">false</span>

         <span class="n">root_attribute</span> <span class="ss">:version</span><span class="p">,</span>
                        <span class="ss">:required</span> <span class="o">=&gt;</span> <span class="kp">true</span>
         <span class="c1"># ...</span>
      <span class="k">end</span>
   <span class="k">end</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥çœ‹å‡º name å’Œ version çš„æ–¹æ³•å£°æ˜ä¸æ™®é€šçš„ä¸å¤ªä¸€æ ·ï¼Œå…¶å® <code>attribute</code> å’Œ <code>root_attribute</code> æ˜¯é€šè¿‡ Ruby çš„æ–¹æ³•åŒ…è£…å™¨æ¥å®ç°çš„ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦çœ‹è¿™é‡Œ ã€Œ<a href="https://github.com/mxchenxiaodong/haha_day/issues/3#">Pythonè£…é¥°å™¨ ä¸ Rubyå®ç°</a>ã€ã€‚</p>
<blockquote>
<p>Tips: Ruby åŸç”Ÿæä¾›çš„å±æ€§è®¿é—®å™¨ &mdash; <code>attr_accessor</code> å¤§å®¶åº”è¯¥ä¸é™Œç”Ÿï¼Œå°±æ˜¯é€šè¿‡åŒ…è£…å™¨å®ç°çš„ã€‚</p>
</blockquote>
<p>è¿™äº›<strong>è£…é¥°å™¨æ‰€å£°æ˜çš„æ–¹æ³•ä¼šåœ¨å…¶æ¨¡å—è¢«åŠ è½½æ—¶åŠ¨æ€ç”Ÿæˆ</strong>ï¼Œæ¥çœ‹å…¶å®ç°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># `lib/cocoapods-core/specification/attribute_support.rb`</span>
<span class="k">module</span> <span class="nn">Pod</span>
 <span class="k">class</span> <span class="nc">Specification</span>
   <span class="k">module</span> <span class="nn">DSL</span>
     <span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span>
       <span class="kp">attr_reader</span> <span class="ss">:attributes</span>
     <span class="k">end</span>

     <span class="k">module</span> <span class="nn">AttributeSupport</span>
         <span class="k">def</span> <span class="nf">root_attribute</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{})</span>
             <span class="n">options</span><span class="o">[</span><span class="ss">:root_only</span><span class="o">]</span> <span class="o">=</span> <span class="kp">true</span>
             <span class="n">options</span><span class="o">[</span><span class="ss">:multi_platform</span><span class="o">]</span> <span class="o">=</span> <span class="kp">false</span>
             <span class="n">store_attribute</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
         <span class="k">end</span>

         <span class="k">def</span> <span class="nf">attribute</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{})</span>
             <span class="n">store_attribute</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
         <span class="k">end</span>

         <span class="k">def</span> <span class="nf">store_attribute</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
             <span class="kp">attr</span> <span class="o">=</span> <span class="no">Attribute</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
             <span class="vi">@attributes</span> <span class="o">||=</span> <span class="p">{}</span>
             <span class="vi">@attributes</span><span class="o">[</span><span class="nb">name</span><span class="o">]</span> <span class="o">=</span> <span class="kp">attr</span>
         <span class="k">end</span>
     <span class="k">end</span>
 <span class="k">end</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p><code>attribute</code> å’Œ <code>root_attribute</code> æœ€ç»ˆéƒ½èµ°åˆ°äº† <code>store_attribute</code> ä¿å­˜åœ¨åˆ›å»ºçš„ Attribute å¯¹è±¡å†…ï¼Œå¹¶ä»¥é…ç½®çš„ Symbol åç§°ä½œä¸º KEY å­˜å…¥ <code>@attributes</code>ï¼Œç”¨äºç”Ÿæˆæœ€ç»ˆçš„ attributes setter æ–¹æ³•ã€‚</p>
<p>æœ€å…³é”®çš„ä¸€æ­¥ï¼Œè®©æˆ‘ä»¬å›åˆ° <em>specification</em> æ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="c1"># `/lib/coocapods-core/specification`</span>
<span class="k">module</span> <span class="nn">Pod</span>
   <span class="k">class</span> <span class="nc">Specification</span>
     <span class="c1"># ...</span>
    
      <span class="k">def</span> <span class="nf">store_attribute</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">platform_name</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">)</span>
         <span class="nb">name</span> <span class="o">=</span> <span class="nb">name</span><span class="o">.</span><span class="n">to_s</span>
         <span class="n">value</span> <span class="o">=</span> <span class="no">Specification</span><span class="o">.</span><span class="n">convert_keys_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">is_a?</span><span class="p">(</span><span class="no">Hash</span><span class="p">)</span>
         <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip_heredoc</span><span class="o">.</span><span class="n">strip</span> <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">respond_to?</span><span class="p">(</span><span class="ss">:strip_heredoc</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">platform_name</span>
             <span class="n">platform_name</span> <span class="o">=</span> <span class="n">platform_name</span><span class="o">.</span><span class="n">to_s</span>
             <span class="n">attributes_hash</span><span class="o">[</span><span class="n">platform_name</span><span class="o">]</span> <span class="o">||=</span> <span class="p">{}</span>
             <span class="n">attributes_hash</span><span class="o">[</span><span class="n">platform_name</span><span class="o">][</span><span class="nb">name</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span>
         <span class="k">else</span>
             <span class="n">attributes_hash</span><span class="o">[</span><span class="nb">name</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span>
         <span class="k">end</span>
      <span class="k">end</span>

      <span class="no">DSL</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">a</span><span class="o">|</span>
         <span class="n">define_method</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">writer_name</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">value</span><span class="o">|</span>
             <span class="n">store_attribute</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
         <span class="k">end</span>

         <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">writer_singular_form</span>
             <span class="n">alias_method</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">writer_singular_form</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">writer_name</span><span class="p">)</span>
         <span class="k">end</span>
      <span class="k">end</span>
   <span class="k">end</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Specification</code> ç±»è¢«åŠ è½½æ—¶ï¼Œä¼šå…ˆéå† <code>DSL</code> module åŠ è½½åæ‰€ä¿å­˜çš„ attributesï¼Œå†é€šè¿‡ <code>define_method</code> åŠ¨æ€ç”Ÿæˆå¯¹åº”çš„é…ç½®æ–¹æ³•ã€‚æœ€ç»ˆæ•°æ®è¿˜æ˜¯ä¿å­˜åœ¨ <code>attributes_hash</code> ä¸­ã€‚</p>
<p><img src="https://i.loli.net/2020/10/08/9zpkhrngNCG87yT.png" alt="05-PodSpec-Load"></p>
<p><strong>Attribute</strong></p>
<p>Attribute æ˜¯ä¸ºäº†è®°å½•è¯¥é…ç½®çš„ç›¸å…³ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œè®°å½• <code>Spec</code> æ˜¯å¦ä¸ºæ ¹èŠ‚ç‚¹ã€<code>Spec</code> ç±»å‹ã€æ‰€æ”¯æŒçš„ platformsã€èµ„æºåœ°å€é€šé…ç¬¦ç­‰ã€‚</p>
<ol>
<li>
<p>ä»¥ <code>root_attribute</code> åŒ…è£…çš„é…ç½®ä»…ç”¨äºä¿®é¥° <code>Spec</code> æ ¹èŠ‚ç‚¹ï¼Œæ¯”å¦‚ç‰ˆæœ¬å· <code>version</code> åªèƒ½ç”± <code>Spec</code> æ ¹èŠ‚ç‚¹æ¥è®¾ç½®ï¼Œå¦å¤–è¿˜æœ‰ <code>source</code>ã€<code>static_framework</code>ã€<code>module_name</code> ç­‰ï¼›</p>
</li>
<li>
<p>ä»¥ <code>attribute</code> åŒ…è£…çš„é…ç½®åˆ™ä¸é™æ˜¯å¦ä¸º <code>Spec</code> æ ¹ç»“ç‚¹ã€‚æˆ‘ä»¬ä»¥ AFNetworking çš„ <code>source_files</code> ä¸ºä¾‹ï¼šç”±äºåœ¨ macOS å’Œ watchOS ä¸Šå¹¶æ²¡æœ‰ UIKit framworkï¼Œå› æ­¤å®ƒå•ç‹¬å°† UIKit çš„ç›¸å…³åŠŸèƒ½æ‹†åˆ†åˆ°äº† <code>AFNetworking/UIKit</code> ä¸­ï¼›</p>
</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="no">Pod</span><span class="o">::</span><span class="no">Spec</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="c1"># ...</span>
  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">&#39;NSURLSession&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">ss</span><span class="o">|</span>
	 <span class="c1"># ...</span>
  <span class="k">end</span>

  <span class="n">s</span><span class="o">.</span><span class="n">subspec</span> <span class="s1">&#39;UIKit&#39;</span> <span class="k">do</span> <span class="o">|</span><span class="n">ss</span><span class="o">|</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">ios</span><span class="o">.</span><span class="n">deployment_target</span> <span class="o">=</span> <span class="s1">&#39;9.0&#39;</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">tvos</span><span class="o">.</span><span class="n">deployment_target</span> <span class="o">=</span> <span class="s1">&#39;9.0&#39;</span>
    <span class="n">ss</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;AFNetworking/NSURLSession&#39;</span>

    <span class="n">ss</span><span class="o">.</span><span class="n">source_files</span> <span class="o">=</span> <span class="s1">&#39;UIKit+AFNetworking&#39;</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="subspec">#subspec</h3>
<p>é™¤äº† attribute è£…é¥°å™¨å£°æ˜çš„ setter æ–¹æ³•ï¼Œè¿˜æœ‰å‡ ä¸ªè‡ªå®šä¹‰çš„æ–¹æ³•æ˜¯ç›´æ¥é€šè¿‡ eval è°ƒç”¨çš„ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">subspec</span><span class="p">(</span><span class="nb">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="n">subspec</span> <span class="o">=</span> <span class="no">Specification</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="nb">name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="vi">@subspecs</span> <span class="o">&lt;&lt;</span> <span class="n">subspec</span>
  <span class="n">subspec</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">test_spec</span><span class="p">(</span><span class="nb">name</span> <span class="o">=</span> <span class="s1">&#39;Tests&#39;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="n">subspec</span> <span class="o">=</span> <span class="no">Specification</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="nb">name</span><span class="p">,</span> <span class="kp">true</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="vi">@subspecs</span> <span class="o">&lt;&lt;</span> <span class="n">subspec</span>
  <span class="n">subspec</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">app_spec</span><span class="p">(</span><span class="nb">name</span> <span class="o">=</span> <span class="s1">&#39;App&#39;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="n">appspec</span> <span class="o">=</span> <span class="no">Specification</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="nb">name</span><span class="p">,</span> <span class="ss">:app_specification</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
  <span class="vi">@subspecs</span> <span class="o">&lt;&lt;</span> <span class="n">appspec</span>
  <span class="n">appspec</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸‰ç§ä¸åŒç±»å‹çš„ <code>Subspec</code> ç» <code>eval</code> è½¬æ¢ä¸ºå¯¹åº”çš„ <code>Specification</code> å¯¹è±¡ï¼Œæ³¨æ„è¿™é‡Œåˆå§‹åŒ–åéƒ½å°† parent èŠ‚ç‚¹æŒ‡å‘ <strong>self</strong> åŒæ—¶å­˜å…¥ <code>@subspecs</code> æ•°ç»„ä¸­ï¼Œå®Œæˆ <code>SubSpec</code> ä¾èµ–é“¾çš„æ„é€ ã€‚</p>
<h3 id="dependency">#dependency</h3>
<p>å¯¹äºå…¶ä»– <code>pod</code> ä¾èµ–çš„æ·»åŠ æˆ‘ä»¬é€šè¿‡ dependency æ–¹æ³•æ¥å®ç°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="k">def</span> <span class="nf">dependency</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
   <span class="nb">name</span><span class="p">,</span> <span class="o">*</span><span class="n">version_requirements</span> <span class="o">=</span> <span class="n">args</span>
   <span class="c1"># dependency args æœ‰æ•ˆæ€§æ ¡éªŒ ...</span>

   <span class="n">attributes_hash</span><span class="o">[</span><span class="s1">&#39;dependencies&#39;</span><span class="o">]</span> <span class="o">||=</span> <span class="p">{}</span>
   <span class="n">attributes_hash</span><span class="o">[</span><span class="s1">&#39;dependencies&#39;</span><span class="o">][</span><span class="nb">name</span><span class="o">]</span> <span class="o">=</span> <span class="n">version_requirements</span>

   <span class="k">unless</span> <span class="n">whitelisted_configurations</span><span class="o">.</span><span class="n">nil?</span>
   <span class="c1"># configuration ç™½åå•è¿‡æ»¤å’Œæ ¡éªŒ ...</span>

   <span class="n">attributes_hash</span><span class="o">[</span><span class="s1">&#39;configuration_pod_whitelist&#39;</span><span class="o">]</span> <span class="o">||=</span> <span class="p">{}</span>
   <span class="n">attributes_hash</span><span class="o">[</span><span class="s1">&#39;configuration_pod_whitelist&#39;</span><span class="o">][</span><span class="nb">name</span><span class="o">]</span> <span class="o">=</span> <span class="n">whitelisted_configurations</span>
   <span class="k">end</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p>dependency æ–¹æ³•å†…éƒ¨ä¸»è¦æ˜¯å¯¹ä¾èµ–æœ‰æ•ˆæ€§çš„æ ¡éªŒï¼Œé™äºç¯‡å¹…è¿™é‡Œä¸åˆ—å‡ºå®ç°ï¼Œæ ¸å¿ƒè¦ç‚¹å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>æ£€æŸ¥ä¾èµ–å¾ªç¯</strong>ï¼Œæ ¹æ® <code>Spec</code> åç§°åˆ¤æ–­ <code>Spec</code> ä¸è‡ªèº«ï¼Œ<code>Spec</code> ä¸<code>SubSpec</code>ä¹‹é—´æ˜¯å¦å­˜åœ¨å¾ªç¯ä¾èµ–ï¼›</li>
<li><strong>æ£€æŸ¥ä¾èµ–æ¥æº</strong>ï¼Œ<code>PodSpec</code> ä¸­ä¸æ”¯æŒ <code>:git</code> æˆ– <code>:path</code> å½¢å¼çš„æ¥æºæŒ‡å®šï¼Œå¦‚éœ€è®¾å®šå¯é€šè¿‡ <code>Podfile</code> æ¥ä¿®æ”¹;</li>
<li><strong>æ£€æŸ¥ configuation ç™½åå•</strong>ï¼Œç›®å‰ä»…æ”¯æŒ Xcode é»˜è®¤çš„ <code>Debug</code> å’Œ <code>Release</code> çš„ configuration é…ç½®ï¼›</li>
</ol>
<h1 id="åˆ›å»ºå¹¶ä½¿ç”¨ä½ çš„-pod">åˆ›å»ºå¹¶ä½¿ç”¨ä½ çš„ Pod</h1>
<p>æœ€åä¸€èŠ‚æ¥ä¸¤ä¸ªå®è·µï¼šåˆ›å»º Pod ä»¥åŠåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ <code>SubSpecs</code>ã€‚</p>
<h2 id="pod-åˆ›å»º">Pod åˆ›å»º</h2>
<p>pod ç›¸å…³ä½¿ç”¨å®˜æ–¹éƒ½æä¾›äº†å¾ˆè¯¦å°½çš„éƒ½æ–‡æ¡£ï¼Œæœ¬å°èŠ‚ä»…åšä»‹ç»ã€‚</p>
<h3 id="0x1-åˆ›å»º-pod">0x1 åˆ›å»º Pod</h3>
<p>ä»…éœ€ä¸€è¡Œå‘½ä»¤å®Œæˆ <code>Pod</code> åˆ›å»ºï¼ˆ<a href="https://guides.cocoapods.org/making/using-pod-lib-create.html">æ–‡æ¡£</a>ï¼‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ pod lib create <span class="sb">`</span>NAME<span class="sb">`</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¹‹åæ¯ä¸€æ­¥éƒ½ä¼šè¾“å‡ºå‹å¥½æç¤ºï¼ŒæŒ‰ç…§æç¤ºé€‰æ‹©å³å¯ã€‚åœ¨æ·»åŠ å®Œ source code å’Œ dependency ä¹‹åï¼Œä½ è¿˜å¯ä»¥åœ¨ CocoaPods ä¸ºä½ æä¾›çš„ Example é¡¹ç›®ä¸­è¿è¡Œå’Œè°ƒè¯•ä»£ç ã€‚</p>
<p>å‡†å¤‡å°±ç»ªåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ ¡éªŒï¼Œæ£€æŸ¥ <code>Pod</code> æ­£ç¡®æ€§ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ pod lib lint <span class="sb">`</span><span class="o">[</span>PODSPEC_PATHS ...<span class="o">]</span><span class="sb">`</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="0x2-å‘å¸ƒ-pod">0x2 å‘å¸ƒ Pod</h3>
<p>æ ¡éªŒé€šè¿‡åå°±å¯ä»¥å°† <code>Pod</code> å‘å¸ƒäº†ï¼Œä½ å¯ä»¥å°† <code>PodSepc</code> å‘å¸ƒåˆ°  Master Repo ä¸Šï¼Œæˆ–è€…å‘å¸ƒåˆ°å†…éƒ¨çš„ Spec Repo ä¸Šã€‚</p>
<p><strong>CocoaPods Master Repo</strong></p>
<p>å¦‚æœå‘å¸ƒçš„ CocoaPods çš„ä¸»ä»“åº“ï¼Œé‚£ä¹ˆéœ€è¦é€šè¿‡ CocoaPods æä¾›çš„ <strong>Trunk</strong> å‘½ä»¤ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ pod trunk push <span class="sb">`</span><span class="o">[</span>NAME.podspec<span class="o">]</span><span class="sb">`</span>
</code></pre></td></tr></table>
</div>
</div><p>ä¸è¿‡ä½¿ç”¨å‰éœ€è¦å…ˆé€šè¿‡é‚®ç®±æ³¨å†Œï¼Œè¯¦æƒ…æŸ¥çœ‹<a href="https://guides.cocoapods.org/making/getting-setup-with-trunk.html">æ–‡æ¡£</a>ã€‚</p>
<p><strong>Private Spec Repo</strong></p>
<p>å¯¹äºå‘å¸ƒåˆ°ç§æœ‰ä»“åº“çš„ï¼Œå¯é€šè¿‡ CocoaPods æä¾›çš„ <strong>Repo</strong> å‘½ä»¤ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">$ pod repo push <span class="sb">`</span>REPO_NAME<span class="sb">`</span> <span class="sb">`</span>SPEC_NAME.podspec<span class="sb">`</span>
</code></pre></td></tr></table>
</div>
</div><p>æ–‡æ¡£è¯¦æƒ… &mdash; <a href="https://guides.cocoapods.org/making/private-cocoapods.html">ä¼ é€é—¨</a>ã€‚</p>
<h2 id="subspecs-in-podfile">SubSpecs In Podfile</h2>
<p>åœ¨ <code>SubSpec</code> ä¸€èŠ‚æåˆ°è¿‡ï¼Œåœ¨ CocoaPods ä¸­ <code>SubSpec</code> æ˜¯è¢«ä½œä¸ºå•ç‹¬çš„ä¾èµ–æ¥çœ‹å¾…çš„ï¼Œè¿™é‡Œå°±å€Ÿè¿™ä¸ªå®æ“æ¥è¯æ˜ä¸€ä¸‹ã€‚</p>
<p>åœ¨ä¸Šæ–‡çš„å®è·µä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æ¯ä¸€ä¸ª <code>Pod</code> åº“å¯¹åº”ä¸º Xcode é¡¹ç›®ä¸­çš„ä¸€ä¸ªä¸ª targetï¼Œé‚£ä¹ˆå½“æ˜ç¡®æŒ‡å®šéƒ¨åˆ† <code>SubSpec</code> æ—¶ï¼Œå®ƒä»¬ä¹Ÿå°†è¢«ä½œä¸ºç‹¬ç«‹çš„ target è¿›è¡Œç¼–è¯‘ã€‚ä¸è¿‡è¿™é‡Œéœ€è¦æ˜ç¡®ä¸€ä¸‹ä½¿ç”¨åœºæ™¯ï¼š</p>
<h3 id="0x1-single-target">0x1 Single Target</h3>
<p>å½“ä¸»é¡¹ç›®ä¸­ä»…æœ‰ä¸€ä¸ª target æˆ–å¤šä¸ª target å¼•ç”¨äº†åŒä¸€ä¸ª <code>pod</code> åº“çš„å¤šä¸ªä¸åŒ <code>SubSpec</code> æ—¶ï¼Œç”Ÿæˆçš„ target åªä¼šæœ‰ä¸€ä¸ªã€‚æˆ‘ä»¬ä»¥ QMUIKit ä¸ºä¾‹ï¼Œé¡¹ç›® Demo.project ä¸‹çš„ Podfile é…ç½®å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">target</span> <span class="s1">&#39;Demo&#39;</span> <span class="k">do</span>
  <span class="n">pod</span> <span class="s1">&#39;QMUIKit/QMUIComponents/QMUILabel&#39;</span><span class="p">,</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">&#39;../QMUI_iOS&#39;</span>
  <span class="n">pod</span> <span class="s1">&#39;QMUIKit/QMUIComponents/QMUIButton&#39;</span><span class="p">,</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">&#39;../QMUI_iOS&#39;</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://i.loli.net/2020/10/08/UvaHxjwkI8CofhZ.png" alt="06-podspec-single"></p>
<p>æ­¤æ—¶ <code>Pods.project</code> ä¸‹çš„ QMUIKit çš„ target åç§°ä¸º <strong>QMUIKit</strong>ã€‚</p>
<h3 id="0x2-multiple-target">0x2 Multiple Target</h3>
<p>å¦‚æœæˆ‘ä»¬çš„ä¸»é¡¹ç›®ä¸­å­˜åœ¨å¤šä¸ª target ä¸”ä½¿ç”¨åŒä¸€ä¸ª <code>pod</code> åº“çš„ä¸åŒ <code>SubSpec</code> æ—¶ï¼Œç»“æœåˆ™æœ‰æ‰€ä¸åŒã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬åœ¨ 0x1 çš„åŸºç¡€ä¸Šæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-ruby" data-lang="ruby"><span class="n">target</span> <span class="s1">&#39;Demo2&#39;</span> <span class="k">do</span>
	<span class="n">pod</span> <span class="s1">&#39;QMUIKit/QMUIComponents/QMUILog&#39;</span><span class="p">,</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">&#39;../QMUI_iOS&#39;</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://i.loli.net/2020/10/08/OXEcuGNfoMHyJ6g.png" alt="07-podspec-mutil"></p>
<p>å¯ä»¥å‘ç°ï¼ŒCocoaPods ä¸ºæ¯ä¸ª tareget å¯¹åº”çš„ <code>SubSpec</code> ä¾èµ–ç”Ÿæˆäº†ä¸åŒçš„ QMUIKit targetsã€‚</p>
<blockquote>
<p>Tips: å½“ä¸»å·¥ç¨‹ target ä¾èµ–çš„ <code>Subspec</code> æ•°é‡è¿‡å¤šå¯¼è‡´çš„åç§°è¶…è¿‡ 50 ä¸ªå­—ç¬¦ï¼Œå°†ä¼šå¯¹ subspec åç¼€åšæ‘˜è¦å¤„ç†ä½œä¸ºå”¯ä¸€æ ‡è¯†ç¬¦ã€‚</p>
</blockquote>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<p>æœ¬æ–‡æ˜¯ CocoaPods-Core çš„ç¬¬äºŒç¯‡ï¼Œé‡ç‚¹ä»‹ç»äº† <code>PodSpec</code> çš„ç±»æ„æˆå’Œè§£æå®ç°ï¼Œæ€»ç»“å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆæ¢ <code>PodSpec</code> è®©æˆ‘ä»¬å¯¹å…¶èƒ½åŠ›è¾¹ç•Œå’Œé…ç½®åˆ†ç±»æœ‰äº†æ›´å¥½çš„äº†è§£ï¼›</li>
<li>æ·±å…¥ <code>PodSpec</code> æˆ‘ä»¬å‘ç°å…¶æ•°æ®ç»“æ„åŒ <code>Podfile</code> ç±»ä¼¼ï¼Œéƒ½æ˜¯æ ¹æ®ä¾èµ–å…³ç³»å»ºç«‹å¯¹åº”çš„æ ‘ç»“æ„ï¼›</li>
<li><code>PodSpec</code> é’ˆå¯¹å•ä¸ªåº“çš„æºç å’Œèµ„æºæä¾›äº†æ›´ç²¾ç»†åŒ–çš„ç®¡ç†ï¼Œ<code>SubSpec</code> ç»“æ„çš„æ¨å‡ºè®©å¤§å‹ library çš„å†…éƒ¨åˆ†å±‚æä¾›äº†å¾ˆå¥½çš„å·¥å…·ï¼›</li>
<li>è£…é¥°å™¨æ¨¡å¼ç»“åˆ Ruby çš„åŠ¨æ€ç‰¹æ€§ï¼Œè®© <code>PodSpec</code> çš„ DSL ç‰¹æ€§çš„å®ç°èµ·æ¥æ›´åŠ ä¼˜é›…ï¼›</li>
</ol>
<h1 id="çŸ¥è¯†ç‚¹é—®é¢˜æ¢³ç†">çŸ¥è¯†ç‚¹é—®é¢˜æ¢³ç†</h1>
<p>è¿™é‡Œç½—åˆ—äº†å››ä¸ªé—®é¢˜ç”¨æ¥è€ƒå¯Ÿä½ æ˜¯å¦å·²ç»æŒæ¡äº†è¿™ç¯‡æ–‡ç« ï¼Œå¦‚æœæ²¡æœ‰å»ºè®®ä½ åŠ å…¥<strong>æ”¶è—</strong>å†æ¬¡é˜…è¯»ï¼š</p>
<ol>
<li>è¯´è¯´ <code>PodSpec</code> æ‰€æ”¯æŒçš„é…ç½®æœ‰å‡ ç±»ï¼Œåˆ†åˆ«å…·æœ‰å“ªäº›åŠŸèƒ½ ï¼Ÿ</li>
<li><code>PodSpec</code> ä¸ <code>SubSpec</code> ä¹‹é—´æœ‰å“ªäº›å…³ç³» ï¼Ÿ</li>
<li>è¯´è¯´ <code>SubSpec</code> çš„ç‰¹ç‚¹ä»¥åŠä½œç”¨ ï¼Ÿ</li>
<li>è°ˆè°ˆ <code>PodSpec</code> ä¸­çš„ DSL è§£æä¸ <code>Podfile</code> çš„è§£æå®ç°æœ‰å“ªäº›åŒºåˆ« ï¼Ÿ</li>
</ol>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">æ–‡ç« ä½œè€…</span>
    <span class="item-content">åœŸåœŸEdmondæœ¨</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">ä¸Šæ¬¡æ›´æ–°</span>
    <span class="item-content">
        2020-10-13
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/cocoapods/">CocoaPods</a>
          <a href="/tags/ios/">iOS</a>
          <a href="/tags/ruby/">Ruby</a>
          </div>
      <nav class="post-nav">
        
        <a class="next" href="/post/sourcecode-cocoapods/04-cocoapods-podfile/">
            <span class="next-text nav-default">4. Podfile çš„è§£æé€»è¾‘</span>
            <span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="looseyi/looseyi.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:chun574271939@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://twitter.com/looseyi" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://github.com/looseyi" class="iconfont icon-github" title="github"></a>
      <a href="https://www.weibo.com/foreverclp" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/people/tu-tu-edmondmu" class="iconfont icon-zhihu" title="zhihu"></a>
  <a href="http://looseyi.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    ç”± <a class="hexo-link" href="https://gohugo.io">Hugo</a> å¼ºåŠ›é©±åŠ¨
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    ä¸»é¢˜ - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019-12-11 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">åœŸåœŸEdmondæœ¨</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-62789092-1', 'auto');
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>







</body>
</html>
